// src/main/ets/pages/MainPage.ets (å®Œæ•´æœ€ç»ˆç‰ˆ)

import { WeeklyCourseViewModel } from '../viewmodel/WeeklyCourseViewModel';
import { Index } from './Index' // å¯¼å…¥å‘¨è§†å›¾é¡µé¢

@Entry
@Component
struct MainPage {
  @State currentTabIndex: number = 1; // é»˜è®¤é€‰ä¸­ä¸­é—´çš„â€œè¯¾ç¨‹è¡¨â€Tab
  private controller: TabsController = new TabsController();

  // â˜…â˜…â˜… æ ¸å¿ƒï¼šåœ¨æœ€é¡¶å±‚æä¾›currentWeekçŠ¶æ€ â˜…â˜…â˜…
  @Provide('currentWeek') currentWeek: number = 15; // é»˜è®¤ç¬¬15å‘¨

  build() {
    Tabs({ barPosition: BarPosition.End, controller: this.controller }) {
      // --- Tab 1: ä»Šæ—¥è¯¾ç¨‹ ---
      TabContent() {
        // ä½ æœªæ¥åˆ›å»ºçš„â€œä»Šæ—¥è¯¾ç¨‹â€é¡µé¢
        Column(){
          Text("ä»Šæ—¥è¯¾ç¨‹é¡µé¢")
            .fontSize(30)
            .fontWeight(FontWeight.Bold)
        }.width('100%').height('100%').justifyContent(FlexAlign.Center)

      }
      .tabBar(this.TabBuilder('ä»Šæ—¥', 0, 'ðŸ“š'))

      // --- Tab 2: è¯¾ç¨‹è¡¨ (æˆ‘ä»¬çš„Indexé¡µé¢) ---
      TabContent() {
        // å°†Indexç»„ä»¶ä½œä¸ºTabçš„å†…å®¹
        Index()
      }
      .tabBar(this.TabBuilder('è¯¾ç¨‹è¡¨', 1, 'ðŸ“…'))

      // --- Tab 3: è®¾ç½® ---
      TabContent() {
        // ä½ æœªæ¥åˆ›å»ºçš„â€œè®¾ç½®â€é¡µé¢
        Column(){
          Text("è®¾ç½®é¡µé¢")
            .fontSize(30)
            .fontWeight(FontWeight.Bold)
        }.width('100%').height('100%').justifyContent(FlexAlign.Center)
      }
      .tabBar(this.TabBuilder('æˆ‘çš„', 2, 'âš™ï¸'))
    }
    .onChange((index: number) => {
      this.currentTabIndex = index;
    })
    .barWidth('100%')
    .barHeight(60)
    .backgroundColor('#F1F3F5')
    .animationDuration(200)
  }

  // è‡ªå®šä¹‰TabBarçš„æž„å»ºå™¨
  @Builder
  TabBuilder(title: string, index: number, icon: string) {
    Column({ space: 4 }) {
      Text(icon)
        .fontSize(24)
      Text(title)
        .fontSize(12)
        .fontColor(this.currentTabIndex === index ? '#007DFF' : '#666666')
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
  }
}